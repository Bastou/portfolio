function ready(e){"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function loadJS(e,n){var t=document.createElement("script");t.type="application/javascript",t.src=e,u(n).each(function(e,n){u(e).append(t)})}function getJSON(e,n){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="json",t.onload=function(){var e=t.status;200==e?n(null,t.response):n(e)},t.send()}!function(e){"use strict";var n={};n.name="Bastien Cornier",n.ready=function(){u(".main-wrapper");u("html").removeClass("no-js").addClass("js"),n.imgRetina(),n.pageTransitions(),n.videoPlayOnScroll(),n.testReady(),n.menuContact(),n.loadLabItem(),n.onResizeFuncs()},n.regionCheck=function(){getJSON("//freegeoip.net/json/",function(e,n){null!=e?console.error(e):"OCC"==n.region_code&&"92.93.46.141"!==n.ip&&u(".main-wrapper").replace('<div class="center absolute-fit fade-top fade-top-active"><p class="temp h1 absolute-center" style="margin-top: 0;color: rgb(6, 13, 47);">Coming soon</p></div>')})},n.regionCheck(),n.clickFeedbackFx=function(){u("body").on("click",".link",function(){var e=u(this).children(".link-fx--feedback");anime({targets:e.nodes[0],easing:[.1,1,.3,1],opacity:[{value:1,duration:10},{value:0,duration:400,delay:50}],scale:{value:[1,30],duration:900}})})},n.clickFeedbackFx(),n.pagination=function(){u("body").find(".pagination-item").each(function(e){e.addEventListener("mouseenter",function(){u(".pagination-thumb[data-page-orientation='"+u(this).attr("data-page-orientation")+"']").addClass("hover"),u(this).children(".btn").addClass("hover")}),e.addEventListener("mouseleave",function(){u(".pagination-thumb[data-page-orientation='"+u(this).attr("data-page-orientation")+"']").removeClass("hover"),u(this).children(".btn").removeClass("hover")})})},n.pagination(),n.videoPlayOnScroll=function(){document.addEventListener("scroll",function(n){var t=e.innerHeight/3;e.pageYOffset;u(".video-box").each(function(e){var n=u(e).size().top;n<t&-n<t?e.paused&&e.play():e.paused||e.pause()})})},n.pageTransitions=function(){function t(){}var a,i=u(".fx-transition-bubble"),o=i.nodes[0].style,s=u(".fx-transition-bubble-wrapper");Barba.Pjax.init(),Barba.Prefetch.init(),Barba.Dispatcher.on("linkClicked",function(e){a=e});var r=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){var e=u(this.oldContainer);return e.nodes[0].style.opacity=1,e.removeClass("fadeIn").addClass("fadeOut"),new Promise(function(n){e.nodes[0].addEventListener("animationend",function t(){e.nodes[0].removeEventListener("animationend",t),n()})})},fadeIn:function(){var n=u(this.newContainer),t=n.nodes[0].style;e.scroll(0,0),u(this.oldContainer).nodes[0].style.display="none",t.visibility="visible",t.opacity=0,n.removeClass("fadeOut").addClass("fadeIn"),n.nodes[0].addEventListener("animationend",this.done(),!1)}}),d=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.maskOldContainer()]).then(this.movePages.bind(this))},maskOldContainer:function(){var e=Barba.Utils.deferred();return t.bubbleGrow(a,e),e.promise},movePages:function(){var e=u(this.newContainer),n=e.nodes[0].style;e.hasClass("page-lab")&&loadJS("https://production-assets.codepen.io/assets/embed/ei.js",".listing__item__embed"),e.addClass("new-container"),u(this.oldContainer).nodes[0].style.display="none",u(this.oldContainer).removeClass("new-container"),n.visibility="visible",n.opacity=1,o.cssText=null,o.display="none",t.pageElementAppears.apply(this)}}),l=d.extend({maskOldContainer:function(){var e=Barba.Utils.deferred();return s.addClass("fx-transition-bubble-wrapper--bordered"),i.addClass("fx-transition-bubble--white"),t.bubbleGrow(a,e),e.promise},movePages:function(){var e=u(this.newContainer),n=e.nodes[0].style;e.addClass("new-container"),e.removeClass("init"),n.visibility="visible",n.opacity=1,o.cssText=null,o.display="none",i.removeClass("fx-transition-bubble--white"),s.removeClass("fx-transition-bubble-wrapper--bordered"),u(this.oldContainer).nodes[0].style.display="none",t.pageElementAppears.apply(this)}}),c=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.maskOldContainer()]).then(this.movePages.bind(this))},maskOldContainer:function(){var n=Barba.Utils.deferred(),t=u(a).closest(".listing__item"),i=t.find(".listing__item__title"),o=t.find(".fx-bg-reveal"),s=anime.timeline();return t.addClass("listingItem--active"),e.scroll(0,0),s.add({targets:".listing__item:not(.listingItem--active)",opacity:0,easing:"easeOutCirc",duration:300}).add({targets:t.nodes[0],translateY:-t.size().top,backgroundColor:"#BBBBBB",height:540,offset:100,easing:"easeOutCirc",duration:300}).add({targets:[i.nodes[0],o.nodes[0]],opacity:0,offset:100,easing:"easeOutCirc",duration:300,complete:function(e){n.resolve()}}),n.promise},movePages:function(){var e=this,n=u(this.newContainer),t=n.nodes[0].style,a=u("#article-banner-image"),i=u("#post-content-fx-cover");u(this.newContainer).addClass("absolute-fit new-container"),t.visibility="visible",t.opacity=1,n.removeClass("absolute-fit"),anime.timeline().add({targets:this.oldContainer,opacity:{value:[1,0],delay:50,duration:10},easing:"easeOutCirc",complete:function(n){u(this.oldContainer).removeClass("new-container"),u(e.oldContainer).nodes[0].style.visibility="hidden",u(e.oldContainer).nodes[0].style.display="none"}}).add({targets:a.nodes[0],opacity:{value:[0,1],duration:1200,delay:800},easing:"easeOutCirc"}).add({targets:i.nodes[0],width:{value:[0,"100%"],duration:700},easing:"easeOutCirc",offset:50}).add({targets:".new-container .smFadeIn",easing:"easeOutExpo",opacity:{value:[1,1],duration:10},offset:50}).add({targets:".new-container .smFadeInTop",easing:"easeOutCirc",opacity:{value:[0,1],duration:400},translateY:{value:[70,0],duration:400},offset:100,delay:function(e,n,t){return 50*n},complete:function(n){e.done()}})}});Barba.Pjax.getTransition=function(){var e=u(a).attr("data-transition");return"postIn"==e?c:"bubble-to-home"==e?l:"bubble"==e?d:r},Barba.BaseView.extend({namespace:"default",onEnter:function(){n.imgRetina()},onEnterCompleted:function(){n.menuContact(),n.loadLabItem()}}).init(),Barba.BaseView.extend({namespace:"post",onEnter:function(){n.pagination(),n.imgRetina()},onEnterCompleted:function(){n.menuContact()},onLeave:function(){},onLeaveCompleted:function(){}}).init(),t.bubbleGrow=function(e,n,t){var t=t||!1,a=u(e).size();o.cssText=null,o.top=a.top+a.height/2+"px",o.left=a.left+a.width/2+"px",o.display="block";var s=anime({targets:i.nodes[0],easing:"easeInCirc",opacity:{value:[0,1],duration:70,delay:320},scale:{value:[0,250],duration:320,delay:320},update:function(e){Math.round(e.progress)>93&&n.resolve()}});return!1===t?s.play():s.reverse(),n.promise},t.pageElementAppears=function(){var e=this,n=u(".smFadeInTop");anime.timeline().add({targets:".new-container .smFadeIn",easing:"easeOutExpo",opacity:{value:[0,1],duration:100}}).add({targets:".new-container .smFadeInTop",easing:"easeOutCirc",opacity:{value:[0,1],duration:500},translateY:{value:[70,0],duration:500},offset:"-=250",delay:function(e,n,t){return 60*n},complete:function(t){n.each(function(e){e.style.pointerEvents=""}),e.done()}})}},n.loadHome=function(){var e=u(".smFadeInTop"),t=u(".main-wrapper");n.onResizeFuncs(),t.addClass("show-home new-container"),u("#canvas-loader-wrapper").empty(),anime.timeline().add({targets:".show-home",easing:"easeOutExpo",opacity:{value:[0,1],duration:50},borderWidth:{value:["0px","15px"],duration:300,delay:120}}).add({targets:".show-home .smFadeIn",easing:"easeOutExpo",opacity:{value:[0,1],duration:300},offset:240}).add({targets:".show-home .smFadeInTop",easing:"easeOutCirc",opacity:{value:[0,1],duration:600},translateY:{value:[70,0],duration:600},offset:240,delay:function(e,n,t){return 50*n},complete:function(n){e.each(function(e){e.style.pointerEvents=""}),t.removeClass("init")}})},e.loadHome=function(){return n.loadHome()},n.menuContact=function(){if(e.matchMedia("(max-width: 1200px)").matches){var n=u("#contact-link"),t=u("#contact-menu"),a=u("#contact-menu").children("li"),i=!1,o=anime.timeline({autoplay:!1,loop:!1}).add({targets:a.nodes,bottom:{value:function(e,n,t){var i=1-n;return n*a.size().height+.5*Math.pow(i,3)+"px"}},left:{value:function(e,n,t){var a=1-n;return Math.pow(a,3)-n+"px"},delay:function(e,n,t){return 10+20*n}},duration:function(e,n,t){return 50+200*n},elasticity:0,update:function(e){e.completed&&100===e.progress?n.addClass("active"):0===e.progress&&n.removeClass("active"),i=!0}}).add({targets:t.nodes[0],bottom:"100%",duration:50,offset:0,easing:"linear"});e.addEventListener("click",function(e){n.hasClass("active")&&(n.nodes[0].contains(e.target)||(o.play(),o.reverse()))}),n.nodes[0].onclick=function(){n.hasClass("active")?(o.play(),o.reverse()):(i&&o.reverse(),o.play())}}},n.loadLabItem=function(){u("body").find(".listing__item--lab").on("click",function(){var e=u(this).find(".listing__item__embed__thumb"),n=u(this).find("iframe");e.addClass("fadeOut"),n.nodes[0].click()})},n.imgRetina=function(){function n(){return e.devicePixelRatio>1||!(!e.matchMedia||!e.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),                              (min--moz-device-pixel-ratio: 1.5),                              (-o-min-device-pixel-ratio: 3/2),                              (min-resolution: 1.5dppx)").matches)}return void(n()&&(u(".img-2x").map(function(e,n){var t=u(e).attr("src");t=(t=t.replace(".png","@2x.png")).replace(".jpg","@2x.jpg"),u(e).attr("src",t)}),u(".bg-img").map(function(e,n){var t=u(e).attr("style");t=(t=t.replace(".png","@2x.png")).replace(".jpg","@2x.jpg"),u(e).attr({style:t})})))},n.onResizeFuncs=function(){var t,a=function(){clearTimeout(t),t=setTimeout(function(){n.menuContact()},250)}.bind(this);e.addEventListener("resize",a)},n.testReady=function(){},n.testInit=function(){},n.testInit(),ready(n.ready)}(window);